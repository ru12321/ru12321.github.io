<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://mister-hope.github.io/tech/database/mongoDB.html"><meta property="og:site_name" content="Mr.Ru"><meta property="og:title" content="MongoDB"><meta property="og:description" content="MongoDB基础 文档地址: https://docs.mongodb.com/manual/ 简介 说明 百度百科 MongoDB是一个基于分布式文件存储的数据库。由C++语言编写。旨在为WEB应用提供可扩展高性能数据存储解决方案。 MongoDB是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。他支持的数据结构非常松散，是类似json的bson格式，因此可以存储比较复杂的数据类型 。Mongo最大的特点是他支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-01-17T05:52:54.000Z"><meta property="article:published_time" content="2022-08-08T00:00:00.000Z"><meta property="article:modified_time" content="2024-01-17T05:52:54.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"MongoDB","image":[""],"datePublished":"2022-08-08T00:00:00.000Z","dateModified":"2024-01-17T05:52:54.000Z","author":[]}</script><title>MongoDB | Mr.Ru</title><meta name="description" content="MongoDB基础 文档地址: https://docs.mongodb.com/manual/ 简介 说明 百度百科 MongoDB是一个基于分布式文件存储的数据库。由C++语言编写。旨在为WEB应用提供可扩展高性能数据存储解决方案。 MongoDB是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。他支持的数据结构非常松散，是类似json的bson格式，因此可以存储比较复杂的数据类型 。Mongo最大的特点是他支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-08633365.css" as="style"><link rel="stylesheet" href="/assets/style-08633365.css">
    <link rel="modulepreload" href="/assets/app-c5d81740.js"><link rel="modulepreload" href="/assets/framework-715d567f.js"><link rel="modulepreload" href="/assets/mongoDB.html-6d0af355.js"><link rel="modulepreload" href="/assets/mongoDB.html-05311463.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.svg" alt="Mr.Ru"><!----><span class="site-name hide-in-pad">Mr.Ru</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/tech/" class="nav-link active" aria-label="技术学习"><span class="font-icon icon iconfont icon-software" style=""></span>技术学习<!----></a></div><div class="nav-item hide-in-mobile"><a href="/book/" class="nav-link" aria-label="书籍阅读"><span class="font-icon icon iconfont icon-read" style=""></span>书籍阅读<!----></a></div><div class="nav-item hide-in-mobile"><a href="/essay/" class="nav-link" aria-label="个人随笔"><span class="font-icon icon iconfont icon-leaf" style=""></span>个人随笔<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="网站相关"><span class="title"><span class="font-icon icon iconfont icon-profile" style=""></span>网站相关</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/about_me/" class="nav-link" aria-label="关于作者"><span class="font-icon icon iconfont icon-like" style=""></span>关于作者<!----></a></li><li class="dropdown-item"><a href="/timeline/" class="nav-link" aria-label="更新历史"><span class="font-icon icon iconfont icon-time" style=""></span>更新历史<!----></a></li></ul></button></div></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/ru12321" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!--[--><button class="search-pro-button" role="search" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">搜索</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-java" style=""></span><span class="title">计算机基础</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="font-icon icon iconfont icon-java" style=""></span><span class="title">数据库存储</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a aria-current="page" href="/tech/database/mongoDB.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="MongoDB"><!---->MongoDB<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#简介" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="简介"><!---->简介<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#说明" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="说明"><!---->说明<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#历史" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="历史"><!---->历史<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#特点" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="特点"><!---->特点<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#特点-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="特点"><!---->特点<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#应用场景" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="应用场景"><!---->应用场景<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#安装" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="安装"><!---->安装<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#核心概念" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="核心概念"><!---->核心概念<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#库-database" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="库&lt; DataBase&gt;"><!---->库&lt; DataBase&gt;<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#集合-collection" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="集合&lt; Collection&gt;"><!---->集合&lt; Collection&gt;<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#文档-document" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="文档&lt; Document&gt;"><!---->文档&lt; Document&gt;<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#关系总结" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="关系总结"><!---->关系总结<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#基本操作" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="基本操作"><!---->基本操作<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#库-database-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="库&lt; database&gt;"><!---->库&lt; database&gt;<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#集合-collection-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="集合&lt; Collection&gt;"><!---->集合&lt; Collection&gt;<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#文档-document-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="文档&lt; document&gt;"><!---->文档&lt; document&gt;<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#文档查询" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="文档查询"><!---->文档查询<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#语法" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="语法"><!---->语法<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#对比语法" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="对比语法"><!---->对比语法<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#and" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="AND"><!---->AND<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#or" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="OR"><!---->OR<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#and-和-or-联合" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="AND 和 OR 联合"><!---->AND 和 OR 联合<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#数组中查询" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="数组中查询"><!---->数组中查询<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#模糊查询" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="模糊查询"><!---->模糊查询<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#排序" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="排序"><!---->排序<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#分页" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="分页"><!---->分页<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#总条数" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="总条数"><!---->总条数<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#去重" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="去重"><!---->去重<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#指定返回字段" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="指定返回字段"><!---->指定返回字段<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#type" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="$type"><!---->$type<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#说明-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="说明"><!---->说明<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#索引-index" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="索引&lt; index&gt;"><!---->索引&lt; index&gt;<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#说明-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="说明"><!---->说明<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="原理"><!---->原理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#操作" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="操作"><!---->操作<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#复合索引" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="复合索引"><!---->复合索引<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#聚合-aggregate" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="聚合&lt; aggregate&gt;"><!---->聚合&lt; aggregate&gt;<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#说明-3" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="说明"><!---->说明<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/tech/database/mongoDB.html#常见聚合表达式" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="常见聚合表达式"><!---->常见聚合表达式<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/tech/database/mybatis.html" class="nav-link sidebar-link sidebar-page" aria-label="MyBatis"><!---->MyBatis<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/tech/database/mybatis-plus.html" class="nav-link sidebar-link sidebar-page" aria-label="MyBatis-plus"><!---->MyBatis-plus<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-build" style=""></span><span class="title">部署运维</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-build" style=""></span><span class="title">日常记录</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-java" style=""></span><span class="title">java语言</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-java" style=""></span><span class="title">中间件技术</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-hot" style=""></span><span class="title">spring框架</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-hot" style=""></span><span class="title">系统设计</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-hot" style=""></span><span class="title">前端框架</span><span class="arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->MongoDB</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/ru12321" target="_blank" rel="noopener noreferrer">Mr.Ru</a></span><span property="author" content="Mr.Ru"></span></span><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-08-08T00:00:00.000Z"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="page-category-item category6 clickable" role="navigation">database</span><meta property="articleSection" content="database"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 24 分钟</span><meta property="timeRequired" content="PT24M"></span><span class="page-word-info" aria-label="字数🔠" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>约 7252 字</span><meta property="wordCount" content="7252"></span><span class="page-pageview-info" aria-label="访问量🔢" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span class="waline-pageview-count" id="ArtalkPV" data-path="/tech/database/mongoDB.html">...</span></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#mongodb基础" class="router-link-active router-link-exact-active toc-link level1">MongoDB基础</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#简介" class="router-link-active router-link-exact-active toc-link level2">简介</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#说明" class="router-link-active router-link-exact-active toc-link level3">说明</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#历史" class="router-link-active router-link-exact-active toc-link level3">历史</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#特点" class="router-link-active router-link-exact-active toc-link level2">特点</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#特点-1" class="router-link-active router-link-exact-active toc-link level3">特点</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#应用场景" class="router-link-active router-link-exact-active toc-link level3">应用场景</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#安装" class="router-link-active router-link-exact-active toc-link level2">安装</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#核心概念" class="router-link-active router-link-exact-active toc-link level2">核心概念</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#库-database" class="router-link-active router-link-exact-active toc-link level3">库&lt; DataBase&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#集合-collection" class="router-link-active router-link-exact-active toc-link level3">集合&lt; Collection&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#文档-document" class="router-link-active router-link-exact-active toc-link level3">文档&lt; Document&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#关系总结" class="router-link-active router-link-exact-active toc-link level3">关系总结</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#基本操作" class="router-link-active router-link-exact-active toc-link level2">基本操作</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#库-database-1" class="router-link-active router-link-exact-active toc-link level3">库&lt; database&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#集合-collection-1" class="router-link-active router-link-exact-active toc-link level3">集合&lt; Collection&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#文档-document-1" class="router-link-active router-link-exact-active toc-link level3">文档&lt; document&gt;</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#文档查询" class="router-link-active router-link-exact-active toc-link level2">文档查询</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#语法" class="router-link-active router-link-exact-active toc-link level3">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#对比语法" class="router-link-active router-link-exact-active toc-link level3">对比语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#and" class="router-link-active router-link-exact-active toc-link level3">AND</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#or" class="router-link-active router-link-exact-active toc-link level3">OR</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#and-和-or-联合" class="router-link-active router-link-exact-active toc-link level3">AND 和 OR 联合</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#数组中查询" class="router-link-active router-link-exact-active toc-link level3">数组中查询</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#模糊查询" class="router-link-active router-link-exact-active toc-link level3">模糊查询</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#排序" class="router-link-active router-link-exact-active toc-link level3">排序</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#分页" class="router-link-active router-link-exact-active toc-link level3">分页</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#总条数" class="router-link-active router-link-exact-active toc-link level3">总条数</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#去重" class="router-link-active router-link-exact-active toc-link level3">去重</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#指定返回字段" class="router-link-active router-link-exact-active toc-link level3">指定返回字段</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#type" class="router-link-active router-link-exact-active toc-link level2">$type</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#说明-1" class="router-link-active router-link-exact-active toc-link level3">说明</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#索引-index" class="router-link-active router-link-exact-active toc-link level2">索引&lt; index&gt;</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#说明-2" class="router-link-active router-link-exact-active toc-link level3">说明</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#原理" class="router-link-active router-link-exact-active toc-link level3">原理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#操作" class="router-link-active router-link-exact-active toc-link level3">操作</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#复合索引" class="router-link-active router-link-exact-active toc-link level3">复合索引</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#聚合-aggregate" class="router-link-active router-link-exact-active toc-link level2">聚合&lt; aggregate&gt;</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#说明-3" class="router-link-active router-link-exact-active toc-link level3">说明</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#常见聚合表达式" class="router-link-active router-link-exact-active toc-link level3">常见聚合表达式</a></li><!----><!--]--></ul><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#springdata-mongotemplate" class="router-link-active router-link-exact-active toc-link level1">SpringData-MongoTemplate</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#环境搭建" class="router-link-active router-link-exact-active toc-link level3">环境搭建</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#集合操作" class="router-link-active router-link-exact-active toc-link level3">集合操作</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#相关注解" class="router-link-active router-link-exact-active toc-link level3">相关注解</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#文档操作" class="router-link-active router-link-exact-active toc-link level3">文档操作</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#springdata-mongorepository" class="router-link-active router-link-exact-active toc-link level1">SpringData-MongoRepository</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#环境搭建-1" class="router-link-active router-link-exact-active toc-link level3">环境搭建</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#测试mongorepository" class="router-link-active router-link-exact-active toc-link level3">测试mongorepository</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#api整理" class="router-link-active router-link-exact-active toc-link level3">API整理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#spring-data-repository接口" class="router-link-active router-link-exact-active toc-link level3">Spring Data Repository接口</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#mongodb-repository" class="router-link-active router-link-exact-active toc-link level3">MongoDB repository</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#repository-query-keywords" class="router-link-active router-link-exact-active toc-link level3">Repository query keywords</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#example类" class="router-link-active router-link-exact-active toc-link level3">Example类</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#问题讨论" class="router-link-active router-link-exact-active toc-link level1">问题讨论</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#查出一条文档指定字段-json" class="router-link-active router-link-exact-active toc-link level2">查出一条文档指定字段 JSON</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#查出一条文档指定字段-query-field" class="router-link-active router-link-exact-active toc-link level2">查出一条文档指定字段 query.field</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#查出一条文档" class="router-link-active router-link-exact-active toc-link level2">查出一条文档</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/tech/database/mongoDB.html#总结" class="router-link-active router-link-exact-active toc-link level2">总结</a></li><!----><!--]--></ul><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="mongodb基础" tabindex="-1"><a class="header-anchor" href="#mongodb基础" aria-hidden="true">#</a> MongoDB基础</h1><p>文档地址: <a href="https://docs.mongodb.com/manual/" target="_blank" rel="noopener noreferrer">https://docs.mongodb.com/manual/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介" aria-hidden="true">#</a> 简介</h2><h3 id="说明" tabindex="-1"><a class="header-anchor" href="#说明" aria-hidden="true">#</a> 说明</h3><ul><li>百度百科</li></ul><p>MongoDB是一个<code>基于分布式文件存储的数据库</code>。由C++语言编写。旨在<code>为WEB应用提供可扩展高性能数据存储解决方案</code>。</p><p>MongoDB是一个<code>介于关系数据库和非关系数据库</code>之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。他支持的数据结构非常松散，是类似json的bson格式，因此可以存储比较复杂的数据类型 。Mongo最大的特点是他支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，<code>几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引</code>。</p><p>总结: mongoDB 是一个<mark>非关系型</mark> <mark>文档数据库</mark></p><h3 id="历史" tabindex="-1"><a class="header-anchor" href="#历史" aria-hidden="true">#</a> 历史</h3><ul><li>2009年2月，MongoDB数据库首次在数据库领域亮相，打破了关系型数据库一统天下的局面；</li><li>2010年8月, MongoDB 1.6发布。这个版本最大的一个功能就是Sharding，自动分片</li><li>2014年12月, MongoDB 3.0发布。由于收购了WiredTiger 存储引擎，大幅提升了MongoDB的写入性能；</li><li>2015年12月，3.2版本发布，开始支持了关系型数据库的核心功能：关联。你可以一次同时查询多个MongoDB的集合。</li><li>2016年, MongoDB推出Atlas，在AWS、 Azure 和GCP上的MongoDB托管服务；</li><li><strong>2017年10月，MongoDB成功在纳斯达克敲钟</strong>，成为26年来<strong>第一家以数据库产品为主要业务的上市公司。</strong></li><li>2018年6月, MongoDB4.0 发布推出ACID事务支持，<strong>成为第一个支持强事务的NoSQL数据库；</strong></li><li>2018年--至今，MongoDB已经从一个在数据库领域籍籍无名的“小透明”，变成了话题度和热度都很高的“流量”数据库。</li></ul><h2 id="特点" tabindex="-1"><a class="header-anchor" href="#特点" aria-hidden="true">#</a> 特点</h2><h3 id="特点-1" tabindex="-1"><a class="header-anchor" href="#特点-1" aria-hidden="true">#</a> 特点</h3><ul><li>面向集合存储，<strong>易存储对象类型的数据</strong></li><li>支持查询,以及动态查询</li><li>支持RUBY，PYTHON，JAVA，C++，PHP，C#等多种语言</li><li><strong>文件存储格式为BSON</strong>（一种JSON的扩展）</li><li>支持复制和故障恢复和分片</li><li><strong>支持事务支持</strong></li><li>索引 聚合 关联....</li></ul><h3 id="应用场景" tabindex="-1"><a class="header-anchor" href="#应用场景" aria-hidden="true">#</a> 应用场景</h3><p>说明：<strong>事务一致性要求不高的可以放在mongodb中，一些重要是订单金额等数据放在关系型数据库中好点</strong></p><ul><li>游戏应用：使用云数据库MongoDB作为游戏服务器的数据库存储用户信息。用户的游戏装备、积分等直接以内嵌文档的形式存储，方便进行查询与更新。</li><li>物流应用：使用云数据库MongoDB存储订单信息，订单状态在运送过程中会不断更新，以云数据库MongoDB内嵌数组的形式来存储，一次查询就能将订单所有的变更读取出来，方便快捷且一目了然。</li><li>社交应用：使用云数据库MongoDB存储用户信息以及用户发表的朋友圈信息，通过地理位置索引实现附近的人、地点等功能。并且，云数据库MongoDB非常适合用来存储聊天记录，因为它提供了非常丰富的查询，并在写入和读取方面都相对较快。</li><li>视频直播：使用云数据库MongoDB存储用户信息、礼物信息等。</li><li>大数据应用：使用云数据库MongoDB作为大数据的云存储系统，随时进行数据提取分析，掌握行业动态。</li></ul><h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装" aria-hidden="true">#</a> 安装</h2><p>官网社区版，<mark>选择5.0版本的（6.0有Bug）</mark></p><p>1.先启动服务：bin目录cmd然后输入<strong>mongod --dbpath=..\data\db</strong></p><p>2.打开客户端 mongo.exe</p><p>3.MongoDBCompass可视化查看工具</p><h2 id="核心概念" tabindex="-1"><a class="header-anchor" href="#核心概念" aria-hidden="true">#</a> 核心概念</h2><h3 id="库-database" tabindex="-1"><a class="header-anchor" href="#库-database" aria-hidden="true">#</a> 库&lt; DataBase&gt;</h3><p>​ <code>mongodb中的库就类似于传统关系型数据库中库的概念，用来通过不同库隔离不同应用数据</code>。mongodb中可以建立多个数据库。每一个库都有自己的集合和权限，不同的数据库也放置在不同的文件中。默认的数据库为&quot;test&quot;，数据库存储在启动指定的data目录中。</p><h3 id="集合-collection" tabindex="-1"><a class="header-anchor" href="#集合-collection" aria-hidden="true">#</a> 集合&lt; Collection&gt;</h3><p>​ <code>集合就是 MongoDB 文档组，类似于 RDBMS （关系数据库管理系统：Relational Database Management System)中的表的概念</code></p><p>集合存在于数据库中，一个库中可以创建多个集合。每个集合没有固定的结构，这意味着你在对集合可以插入不同格式和类型的数据，但通常情况下我们插入集合的数据都会有一定的关联性。</p><h3 id="文档-document" tabindex="-1"><a class="header-anchor" href="#文档-document" aria-hidden="true">#</a> 文档&lt; Document&gt;</h3><p>文档集合中一条条记录，是一组键值(key-value)对(即 BSON)。MongoDB 的文档不需要设置相同的字段，并且相同的字段不需要相同的数据类型，这与关系型数据库有很大的区别，也是 MongoDB 非常突出的特点。</p><p>一个简单的文档例子如下：</p><h3 id="关系总结" tabindex="-1"><a class="header-anchor" href="#关系总结" aria-hidden="true">#</a> 关系总结</h3><table><thead><tr><th>RDBMS</th><th>MongoDB</th></tr></thead><tbody><tr><td>数据库&lt; database&gt;</td><td>数据库&lt; database&gt;</td></tr><tr><td>表&lt; table&gt;</td><td>集合&lt; collection&gt;</td></tr><tr><td>行&lt; row&gt;</td><td>文档&lt; document&gt;</td></tr><tr><td>列&lt; colume&gt;</td><td>字段&lt; field&gt;</td></tr></tbody></table><h2 id="基本操作" tabindex="-1"><a class="header-anchor" href="#基本操作" aria-hidden="true">#</a> 基本操作</h2><h3 id="库-database-1" tabindex="-1"><a class="header-anchor" href="#库-database-1" aria-hidden="true">#</a> 库&lt; database&gt;</h3><ul><li><p>查看所有库</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> <span class="token keyword">show</span> dbs<span class="token punctuation">;</span><span class="token comment">//推荐用</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://picbed-for-mrru-mdfile.oss-cn-chengdu.aliyuncs.com/mrru-glodon/image-20211214114636572.png" alt="image-20211214114636572" loading="lazy"></p><p><code>注意:</code></p><ul><li><strong><code>admin</code></strong>： 从权限的角度来看，这是&quot;root&quot;数据库。要是将一个用户添加到这个数据库，这个用户自动继承所有数据库的权限。一些特定的服务器端命令也只能从这个数据库运行，比如列出所有的数据库或者关闭服务器。</li><li><strong><code>local</code></strong>: 这个数据永远不会被复制，可以用来存储限于本地单台服务器的任意集合</li><li><strong><code>config</code></strong>: 当Mongo用于分片设置时，config数据库在内部使用，用于保存分片的相关信息。</li></ul></li><li><p>创建数据库</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">use</span> 库名
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>注意: use 代表创建并使用,<mark>当库中没有数据时默认不显示这个库</mark></p><p>添加数据后，show databases才会显示</p></li><li><p>删除数据库</p><ul><li><code>默认删除当前选中的库</code></li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>dropDatabase<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://picbed-for-mrru-mdfile.oss-cn-chengdu.aliyuncs.com/mrru-glodon/image-20211214115339513.png" alt="image-20211214115339513" loading="lazy"></p></li><li><p>查看当前所在库</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><h3 id="集合-collection-1" tabindex="-1"><a class="header-anchor" href="#集合-collection-1" aria-hidden="true">#</a> 集合&lt; Collection&gt;</h3><p>就是mysql中表的概念！</p><ul><li><p>查看库中所有集合</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">show</span> collections<span class="token punctuation">;</span>
<span class="token operator">&gt;</span> <span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>创建集合（表）</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>createCollection<span class="token punctuation">(</span><span class="token string">&#39;集合名称&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>options可以是如下参数：</code></p><table><thead><tr><th style="text-align:left;">字段</th><th style="text-align:left;">类型</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;">capped</td><td style="text-align:left;">布尔</td><td style="text-align:left;">（可选）如果为 true，则创建固定集合。固定集合是指有着固定大小的集合，当达到最大值时，它会自动覆盖最早的文档。 <strong>当该值为 true 时，必须指定 size 参数。</strong></td></tr><tr><td style="text-align:left;">size</td><td style="text-align:left;">数值</td><td style="text-align:left;">（可选）为固定集合指定一个最大值，即字节数。 <strong>如果 capped 为 true，也需要指定该字段。</strong></td></tr><tr><td style="text-align:left;">max</td><td style="text-align:left;">数值</td><td style="text-align:left;">（可选）指定固定集合中包含文档的最大数量。</td></tr></tbody></table></li></ul><p>​ <strong>注意:当集合不存在时,向集合中插入文档也会自动创建该集合。</strong></p><ul><li><p>删除集合</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span><span class="token keyword">drop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><h3 id="文档-document-1" tabindex="-1"><a class="header-anchor" href="#文档-document-1" aria-hidden="true">#</a> 文档&lt; document&gt;</h3><p><strong>注意：方法的参数的语法格式不要写错！</strong></p><p>官方doc: <a href="https://docs.mongodb.com/manual/reference/method/" target="_blank" rel="noopener noreferrer">https://docs.mongodb.com/manual/reference/method/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><ul><li><p>插入文档</p><ul><li><p>单条文档</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span><span class="token keyword">insert</span><span class="token punctuation">(</span>{<span class="token string">&quot;name&quot;</span>:<span class="token string">&quot;编ryb&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;age&quot;</span>:<span class="token number">25</span><span class="token punctuation">,</span><span class="token string">&quot;bir&quot;</span>:<span class="token string">&quot;1997-03-24&quot;</span>}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>多条文档</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span><span class="token keyword">insert</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  	{<span class="token string">&quot;name&quot;</span>:<span class="token string">&quot;ryb&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;age&quot;</span>:<span class="token number">25</span><span class="token punctuation">,</span><span class="token string">&quot;bir&quot;</span>:<span class="token string">&quot;1997-03-24&quot;</span>}<span class="token punctuation">,</span>
  	{<span class="token string">&quot;name&quot;</span>:<span class="token string">&quot;ryb2&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;age&quot;</span>:<span class="token number">25</span><span class="token punctuation">,</span><span class="token string">&quot;bir&quot;</span>:<span class="token string">&quot;1997-03-29&quot;</span>}
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>脚本方式</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">for</span><span class="token punctuation">(</span>let i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">100</span><span class="token punctuation">;</span>i<span class="token operator">+</span><span class="token operator">+</span><span class="token punctuation">)</span>{ 		  db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token keyword">insert</span><span class="token punctuation">(</span>{<span class="token string">&quot;_id&quot;</span>:i<span class="token punctuation">,</span><span class="token string">&quot;name&quot;</span>:<span class="token string">&quot;ruyb_&quot;</span><span class="token operator">+</span>i<span class="token punctuation">,</span><span class="token string">&quot;age&quot;</span>:<span class="token number">25</span>}<span class="token punctuation">)</span><span class="token punctuation">;</span>
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p><code>注意:在 mongodb 中每个文档都会有一个_id作为唯一标识,_id默认会自动生成如果手动指定将使用手动指定的值作为_id 的值。</code></p></li><li><p><strong>查询所有</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>删除文档</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>
   <span class="token operator">&lt;</span>query<span class="token operator">&gt;</span><span class="token punctuation">,</span>
   {
    <span class="token comment">//参数</span>
    justOne: <span class="token operator">&lt;</span><span class="token keyword">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    writeConcern: <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>
   }
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>参数说明：</strong></p><ul><li><strong>query</strong> :<code>可选</code>删除的文档的条件。</li><li><strong>justOne</strong> : <code>可选</code>如果设为 true 或 1，则只删除一个文档，如果不设置该参数，或使用默认值 false，则删除所有匹配条件的文档。</li><li><strong>writeConcern</strong> :<code>可选</code>抛出异常的级别。</li></ul></li><li><p>更新文档</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>
   <span class="token operator">&lt;</span>query<span class="token operator">&gt;</span><span class="token punctuation">,</span>
   <span class="token operator">&lt;</span><span class="token keyword">update</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
   {
     upsert: <span class="token operator">&lt;</span><span class="token keyword">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
     multi: <span class="token operator">&lt;</span><span class="token keyword">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
     writeConcern: <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>
   }
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>参数说明：</strong></p><ul><li><strong>query</strong> : update的查询条件，类似sql update查询内where后面的。</li><li><strong>update</strong> : update的对象和一些更新的操作符（如<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3em;vertical-align:-0.1944em;"></span><span class="mpunct">,</span></span></span></span>inc...）等，也可以理解为sql update查询内set后面的</li><li><strong>upsert</strong> : <code>可选</code>，这个参数的意思是，如果不存在update的记录，是否插入objNew,true为插入，默认是false，不插入。</li><li><strong>multi</strong> : <code>可选</code>，mongodb 默认是false,只更新找到的第一条记录，如果这个参数为true,就把按条件查出来多条记录全部更新。</li><li><strong>writeConcern</strong> :<code>可选</code>，抛出异常的级别。</li></ul><div class="language-markdown line-numbers-mode" data-ext="md"><pre class="language-markdown"><code><span class="token list punctuation">-</span> db.集合名称.update({&quot;name&quot;:&quot;zhangsan&quot;},{name:&quot;11&quot;,bir:new date()}) 
	<span class="token code-snippet code keyword">`这个更新是将符合条件的全部更新成后面的文档,相当于先删除在更新`</span>
<span class="token list punctuation">-</span> db.集合名称.update({&quot;name&quot;:&quot;xiaohei&quot;},{$set:{name:&quot;mingming&quot;}})
	<span class="token code-snippet code keyword">`保留原来数据更新,但是只更新符合条件的第一条数据`</span>
<span class="token list punctuation">-</span> db.集合名称.update({name:”小黑”},{$set:{name:”小明”}},{multi:true})		
	<span class="token code-snippet code keyword">`保留原来数据更新,更新符合条件的所有数据`</span>
<span class="token list punctuation">-</span> db.集合名称.update({name:”小黑”},{$set:{name:”小明”}},{multi:true,upsert:true})
	`保留原来数据更新,更新符合条件的所有数据 没有条件符合时插入数据
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="文档查询" tabindex="-1"><a class="header-anchor" href="#文档查询" aria-hidden="true">#</a> 文档查询</h2><p><strong>MongoDB 查询文档使用 find() 方法。find() 方法以非结构化的方式来显示所有文档。</strong></p><h3 id="语法" tabindex="-1"><a class="header-anchor" href="#语法" aria-hidden="true">#</a> 语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>find<span class="token punctuation">(</span>query<span class="token punctuation">,</span> projection<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><strong>query</strong> ：可选，使用查询操作符指定查询条件</li><li><strong>projection</strong> ：可选，使用投影操作符指定返回的键。查询时返回文档中所有键值， 只需省略该参数即可（默认省略）。</li></ul><p>如果你需要以易读的方式来读取数据，可以使用 pretty() 方法，语法格式如下：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>注意: pretty() 方法以格式化的方式来显示所有文档。</code></p><h3 id="对比语法" tabindex="-1"><a class="header-anchor" href="#对比语法" aria-hidden="true">#</a> 对比语法</h3><p>如果你熟悉常规的 SQL 数据，通过下表可以更好的理解 MongoDB 的条件语句查询：</p><p>注意：<mark>这里的命令行查询可以封装成JSON格式作为参数传递</mark></p><p><img src="https://picbed-for-mrru-mdfile.oss-cn-chengdu.aliyuncs.com/mrru-glodon/image-20211214123631600.png" alt="image-20211214123631600" loading="lazy"></p><h3 id="and" tabindex="-1"><a class="header-anchor" href="#and" aria-hidden="true">#</a> AND</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{key1:value1<span class="token punctuation">,</span> key2:value2<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>}<span class="token punctuation">)</span><span class="token punctuation">.</span>pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="or" tabindex="-1"><a class="header-anchor" href="#or" aria-hidden="true">#</a> OR</h3><p>MongoDB OR 条件语句使用了关键字 <strong>$or</strong>,语法格式如下：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>find<span class="token punctuation">(</span>
   {
      $<span class="token operator">or</span>: <span class="token punctuation">[</span>
         {key1: value1}<span class="token punctuation">,</span> {key2:value2}
      <span class="token punctuation">]</span>
   }
<span class="token punctuation">)</span><span class="token punctuation">.</span>pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>类似于 WHERE 语句：WHERE key1=value1 or key2=value2</code></p><h3 id="and-和-or-联合" tabindex="-1"><a class="header-anchor" href="#and-和-or-联合" aria-hidden="true">#</a> AND 和 OR 联合</h3><p><code>类似SQL语句为：&#39;where age &gt;50 AND (name = &#39;ruyb1&#39; OR name = &#39;ruyb2&#39;)&#39;</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token string">&quot;age&quot;</span>: {$gt:<span class="token number">50</span>}<span class="token punctuation">,</span> $<span class="token operator">or</span>: <span class="token punctuation">[</span>{<span class="token string">&quot;name&quot;</span>: <span class="token string">&quot;ruyb1&quot;</span>}<span class="token punctuation">,</span>{<span class="token string">&quot;name&quot;</span>: <span class="token string">&quot;ruyb2&quot;</span>}<span class="token punctuation">]</span>}<span class="token punctuation">)</span><span class="token punctuation">.</span>pretty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="数组中查询" tabindex="-1"><a class="header-anchor" href="#数组中查询" aria-hidden="true">#</a> 数组中查询</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 测试数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span><span class="token keyword">insert</span><span class="token punctuation">(</span>{ <span class="token string">&quot;_id&quot;</span> : <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">&quot;salary&quot;</span> : <span class="token number">2200</span><span class="token punctuation">,</span> <span class="token string">&quot;likes&quot;</span> : <span class="token punctuation">[</span> <span class="token string">&quot;电视&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;读书&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;game&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span> : <span class="token string">&quot;ruyb_0&quot;</span> }<span class="token punctuation">)</span>
<span class="token comment">-- 执行数组查询</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{likes:<span class="token string">&quot;电视&quot;</span>}<span class="token punctuation">)</span>
<span class="token comment">-- $size 按照数组长度查询</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{likes:{$size:<span class="token number">2</span>}}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="模糊查询" tabindex="-1"><a class="header-anchor" href="#模糊查询" aria-hidden="true">#</a> 模糊查询</h3><p><code>类似 SQL 中为 &#39;where name like &#39;%name%&#39;&#39;</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{likes:<span class="token operator">/</span>ruyb<span class="token operator">/</span>}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>注意:在 mongoDB 中使用正则表达式可以是实现近似模糊查询功能</code></p><h3 id="排序" tabindex="-1"><a class="header-anchor" href="#排序" aria-hidden="true">#</a> 排序</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span>{name:<span class="token number">1</span><span class="token punctuation">,</span>salary:<span class="token number">1</span>}<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token operator">-</span> <span class="token number">1</span> 升序  <span class="token operator">-</span><span class="token number">1</span> 降序
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>类似 SQL 语句为: &#39;order by name,age&#39;</code></p><h3 id="分页" tabindex="-1"><a class="header-anchor" href="#分页" aria-hidden="true">#</a> 分页</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span>{条件}<span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span><span class="token keyword">start</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span><span class="token keyword">rows</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>类似于 SQL 语句为: &#39;limit start,rows&#39;</code></p><h3 id="总条数" tabindex="-1"><a class="header-anchor" href="#总条数" aria-hidden="true">#</a> 总条数</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token string">&quot;name&quot;</span>:<span class="token string">&quot;ruyb_0&quot;</span>}<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>类似于 SQL 语句为: &#39;select count(id) from ....&#39;</code></p><h3 id="去重" tabindex="-1"><a class="header-anchor" href="#去重" aria-hidden="true">#</a> 去重</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span><span class="token keyword">distinct</span><span class="token punctuation">(</span><span class="token string">&#39;字段&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>类似于 SQL 语句为: &#39;select distinct name from ....&#39;</code></p><h3 id="指定返回字段" tabindex="-1"><a class="header-anchor" href="#指定返回字段" aria-hidden="true">#</a> <mark>指定返回字段</mark></h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{条件}<span class="token punctuation">,</span>{name:<span class="token number">1</span><span class="token punctuation">,</span>_id:<span class="token number">0</span>}<span class="token punctuation">)</span> 
<span class="token operator">-</span> 参数<span class="token number">2</span>: <span class="token number">1</span> 返回  <span class="token number">0</span> 不返回    <span class="token identifier"><span class="token punctuation">`</span>注意:1和0不能同时使用<span class="token punctuation">`</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="type" tabindex="-1"><a class="header-anchor" href="#type" aria-hidden="true">#</a> $type</h2><h3 id="说明-1" tabindex="-1"><a class="header-anchor" href="#说明-1" aria-hidden="true">#</a> 说明</h3><p>$type操作符是基于BSON类型来检索集合中匹配的数据类型，并返回结果。</p><p>MongoDB 中可以使用的类型如下表所示：</p><p><img src="https://picbed-for-mrru-mdfile.oss-cn-chengdu.aliyuncs.com/mrru-glodon/image-20211214125324193.png" alt="image-20211214125324193" loading="lazy"></p><ul><li>如果想获取 &quot;col&quot; 集合中 title 为 String 的数据，你可以使用以下命令：</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>db<span class="token punctuation">.</span>col<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token string">&quot;title&quot;</span> : {$<span class="token keyword">type</span> : <span class="token number">2</span>}}<span class="token punctuation">)</span><span class="token punctuation">.</span>pretty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
或
db<span class="token punctuation">.</span>col<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token string">&quot;title&quot;</span> : {$<span class="token keyword">type</span> : <span class="token string">&#39;string&#39;</span>}}<span class="token punctuation">)</span><span class="token punctuation">.</span>pretty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>如果想获取 &quot;col&quot; 集合中 tags 为 Array 的数据，你可以使用以下命令：</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>dge
或
db<span class="token punctuation">.</span>col<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token string">&quot;tags&quot;</span> : {$<span class="token keyword">type</span> : <span class="token string">&#39;array&#39;</span>}}<span class="token punctuation">)</span><span class="token punctuation">.</span>pretty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="索引-index" tabindex="-1"><a class="header-anchor" href="#索引-index" aria-hidden="true">#</a> 索引&lt; index&gt;</h2><p>官方doc：<a href="https://docs.mongodb.com/manual/indexes/" target="_blank" rel="noopener noreferrer">https://docs.mongodb.com/manual/indexes/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="说明-2" tabindex="-1"><a class="header-anchor" href="#说明-2" aria-hidden="true">#</a> 说明</h3><p>索引通常能够极大的提高查询的效率，如果没有索引，MongoDB在读取数据时必须扫描集合中的每个文件并选取那些符合查询条件的记录。这种扫描全集合的查询效率是非常低的，特别在处理大量的数据时，查询可以要花费几十秒甚至几分钟，这对网站的性能是非常致命的。索引是特殊的数据结构，索引存储在一个易于遍历读取的数据集合中，<strong>索引是对数据库表中一列或多列的值进行排序的一种结构。</strong></p><h3 id="原理" tabindex="-1"><a class="header-anchor" href="#原理" aria-hidden="true">#</a> 原理</h3><p><img src="https://picbed-for-mrru-mdfile.oss-cn-chengdu.aliyuncs.com/mrru-glodon/image-20211220093934250.png" alt="image-20211220093934250" loading="lazy"></p><p>从根本上说，MongoDB中的索引与其他数据库系统中的索引类似。MongoDB在集合层面上定义了索引，并支持对MongoDB集合中的任何字段或文档的子字段进行索引。 <strong>非常类似mysql</strong></p><h3 id="操作" tabindex="-1"><a class="header-anchor" href="#操作" aria-hidden="true">#</a> 操作</h3><ul><li><mark>每个集合一定有一个默认的索引 _id</mark></li><li>注意参数的语法格式</li></ul><p>0、创建索引</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>createIndex<span class="token punctuation">(</span><span class="token keyword">keys</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>createIndex<span class="token punctuation">(</span>{<span class="token string">&quot;title&quot;</span>:<span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;description&quot;</span>:<span class="token operator">-</span><span class="token number">1</span>}<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>说明: 语法中 Key 值为你要创建的索引字段，1 为指定按升序创建索引，如果你想按降序来创建索引指定为 -1 即可。</code></p><p>createIndex() 接收可选参数，可选参数列表如下：</p><table><thead><tr><th style="text-align:left;">Parameter</th><th style="text-align:left;">Type</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;"><code>background</code></td><td style="text-align:left;">Boolean</td><td style="text-align:left;">建索引过程会阻塞其它数据库操作，background可指定以后台方式创建索引，即增加 &quot;background&quot; 可选参数。 &quot;background&quot; 默认值为<strong>false</strong>。</td></tr><tr><td style="text-align:left;"><code>unique</code></td><td style="text-align:left;">Boolean</td><td style="text-align:left;">建立的索引是否唯一。指定为true创建唯一索引。默认值为<strong>false</strong>.</td></tr><tr><td style="text-align:left;"><code>name</code></td><td style="text-align:left;">string</td><td style="text-align:left;">索引的名称。如果未指定，MongoDB的通过连接索引的字段名和排序顺序生成一个索引名称。</td></tr><tr><td style="text-align:left;">sparse</td><td style="text-align:left;">Boolean</td><td style="text-align:left;">对文档中不存在的字段数据不启用索引；这个参数需要特别注意，如果设置为true的话，在索引字段中不会查询出不包含对应字段的文档.。默认值为 <strong>false</strong>.</td></tr><tr><td style="text-align:left;">expireAfterSeconds</td><td style="text-align:left;">integer</td><td style="text-align:left;">指定一个以秒为单位的数值，完成 TTL设定，设定集合的生存时间。</td></tr><tr><td style="text-align:left;">v</td><td style="text-align:left;">index version</td><td style="text-align:left;">索引的版本号。默认的索引版本取决于mongod创建索引时运行的版本。</td></tr><tr><td style="text-align:left;">weights</td><td style="text-align:left;">document</td><td style="text-align:left;">索引权重值，数值在 1 到 99,999 之间，表示该索引相对于其他索引字段的得分权重。</td></tr><tr><td style="text-align:left;">default_language</td><td style="text-align:left;">string</td><td style="text-align:left;">对于文本索引，该参数决定了停用词及词干和词器的规则的列表。 默认为英语</td></tr><tr><td style="text-align:left;">language_override</td><td style="text-align:left;">string</td><td style="text-align:left;">对于文本索引，该参数指定了包含在文档中的字段名，语言覆盖默认的language，默认值为 language.</td></tr></tbody></table><p>1、查看集合索引</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>2、查看集合索引大小</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>totalIndexSize<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>3、删除集合所有索引</p><p><strong>_id不会被删除掉</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>dropIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>4、删除集合指定索引</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>dropIndex<span class="token punctuation">(</span><span class="token string">&quot;索引名称&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="复合索引" tabindex="-1"><a class="header-anchor" href="#复合索引" aria-hidden="true">#</a> 复合索引</h3><p>​ 说明: 一个索引的值是由多个 key 进行维护的索引的称之为复合索引</p><ul><li>注意: mongoDB 中复合索引和传统关系型数据库一致都是左前缀原则</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>createIndex<span class="token punctuation">(</span>{<span class="token string">&quot;title&quot;</span>:<span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;description&quot;</span>:<span class="token operator">-</span><span class="token number">1</span>}<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://picbed-for-mrru-mdfile.oss-cn-chengdu.aliyuncs.com/mrru-glodon/image-20211220122531182.png" alt="image-20211220122531182" loading="lazy"></p><h2 id="聚合-aggregate" tabindex="-1"><a class="header-anchor" href="#聚合-aggregate" aria-hidden="true">#</a> 聚合&lt; aggregate&gt;</h2><h3 id="说明-3" tabindex="-1"><a class="header-anchor" href="#说明-3" aria-hidden="true">#</a> 说明</h3><p>MongoDB 中聚合(aggregate)主要用于处理数据(诸如统计平均值，求和等)，并返回计算后的数据结果。有点类似 <strong>SQL</strong> 语句中的 <strong>count(*)</strong>。</p><h3 id="常见聚合表达式" tabindex="-1"><a class="header-anchor" href="#常见聚合表达式" aria-hidden="true">#</a> 常见聚合表达式</h3><p><img src="https://picbed-for-mrru-mdfile.oss-cn-chengdu.aliyuncs.com/mrru-glodon/image-20211214131110733.png" alt="" loading="lazy"></p><h1 id="springdata-mongotemplate" tabindex="-1"><a class="header-anchor" href="#springdata-mongotemplate" aria-hidden="true">#</a> SpringData-MongoTemplate</h1><p>参考文档：<a href="https://blog.csdn.net/dglsx123/article/details/103134976" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/dglsx123/article/details/103134976<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><strong>说明: 这里主要以 springboot 应用为基础应用进行整合开发。</strong></p><p>Spring Data : <code>Spring 数据框架 </code>：封装集成了大多数数据库的操作，如：</p><ul><li><p><code>Spring data JPA </code>：提供了对mysql,orcale,sqlserver的操作；<code>JdbcTemplate</code>：封装了这个对象</p></li><li><p>spring data Redis、spring data Elasticsearch、spring data AMQP；<code>RedisTemplate</code>，<code>ElasticTempalte</code>，<code>AmqpTemplate</code></p></li><li><p><strong>spring data MongoDB；提供了<code>MongoTemplate</code>对象，对mongo进行增删改查</strong></p></li></ul><p>在SpringBoot使用<mark>Spring Data</mark>操作MongoDB</p><h3 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h3><div class="language-markdown line-numbers-mode" data-ext="md"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> 引入依赖</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-mongodb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-markdown line-numbers-mode" data-ext="md"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">#</span> 编写配置</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># 连接到Mongo,mongodb没有开启任何安全协议 即没有开启用户名密码校验</span>
<span class="token comment"># mongodb(协议)://121.5.167.13(主机):27017(端口)/glodon(库名)</span>
<span class="token key attr-name">spring.data.mongodb.uri</span><span class="token punctuation">=</span><span class="token value attr-value">mongodb://127.0.0.1:27017/glodon</span>

<span class="token comment"># mongodb 存在密码的配置</span>
<span class="token comment">#spring.data.mongodb.host=127.0.0.1</span>
<span class="token comment">#spring.data.mongodb.port=27017</span>
<span class="token comment">#spring.data.mongodb.database=glodon</span>
<span class="token comment">#spring.data.mongodb.username=root</span>
<span class="token comment">#spring.data.mongodb.password=root</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>引入依赖后，MongoTemplate对象自动会注入到Spring工厂</p><h3 id="集合操作" tabindex="-1"><a class="header-anchor" href="#集合操作" aria-hidden="true">#</a> 集合操作</h3><ul><li><p>创建集合</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testCreateCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  mongoTemplate<span class="token punctuation">.</span><span class="token function">createCollection</span><span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//参数: 创建集合名称</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>注意:创建集合不能存在,存在报错</code></p></li><li><p>删除集合</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testDeleteCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  mongoTemplate<span class="token punctuation">.</span><span class="token function">dropCollection</span><span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="相关注解" tabindex="-1"><a class="header-anchor" href="#相关注解" aria-hidden="true">#</a> 相关注解</h3><p>mongoTemplate面向对象设计，springframework.data.mongodb 提供了这些简单注解</p><ul><li><p><code>@Document(collection = &quot;users&quot;)</code></p><ul><li>修饰范围: 用在类上</li><li>作用: 用来映射这个类的一个对象为 mongo 中一条文档数据</li><li>属性：注解的值有<code>value 、collection</code> ，用来<strong>指定操作的集合名称</strong></li></ul></li><li><p><code>@Id</code></p><ul><li>修饰范围: 用在成员变量、方法上</li><li>作用： 用来将成员变量的值映射为<mark>文档的_id</mark> 的值</li></ul></li><li><p><code>@Field(value = &quot;username&quot;)</code></p><ul><li>不添加注解的话，<strong>默认是成员变量名</strong>为文档的属性名</li><li>修饰范围: 用在成员变量、方法上</li><li>作用: <mark>用来将成员变量以及值映射为文档中一个key、value对</mark></li><li>属性: 注解的值有 <code>name,value </code>，用来<strong>指定在文档中 key 的名称</strong>，默认为成员变量名</li></ul></li><li><p><code>@Transient</code></p><ul><li>修饰范围: 用在成员变量、方法上</li><li>作用: 用来指定改成员变量，表示该成员变量在<strong>对象转换文档时，不参与文档的序列化</strong></li></ul></li></ul><hr><h3 id="文档操作" tabindex="-1"><a class="header-anchor" href="#文档操作" aria-hidden="true">#</a> 文档操作</h3><h4 id="查询" tabindex="-1"><a class="header-anchor" href="#查询" aria-hidden="true">#</a> 查询</h4><ul><li><p>Criteria</p></li><li><p><img src="https://picbed-for-mrru-mdfile.oss-cn-chengdu.aliyuncs.com/mrru-glodon/image-20211221201808467.png" alt="image-20211221201808467" loading="lazy"></p></li><li><p>常见查询</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFindDoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">//1.查询所有</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> userList <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//2.基于id查询</span>
    <span class="token class-name">User</span> user <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//3.条件查询 参数1：查询条件，参数2：返回类型</span>
    <span class="token comment">//空的query代表查询所有</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> userList1 <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userList1<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//4.等值查询</span>
    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token class-name">Query</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">&quot;ruyb3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> userList2 <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userList2<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//5.&lt; &gt; &lt;= &gt;= and 查询</span>
    <span class="token class-name">Query</span> query1 <span class="token operator">=</span> <span class="token class-name">Query</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;salary&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lt</span><span class="token punctuation">(</span><span class="token number">1300</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">&quot;ruyb1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query1<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//6.or</span>
    <span class="token class-name">Criteria</span> criteria <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Criteria</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orOperator</span><span class="token punctuation">(</span>
        <span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">&quot;ruyb1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;salary&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lt</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Query</span> query2 <span class="token operator">=</span> <span class="token class-name">Query</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users2 <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query2<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users2<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//7.排序</span>
    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    query<span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token class-name">Sort</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span><span class="token class-name">Sort<span class="token punctuation">.</span>Order</span><span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">&quot;salary&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//8.分页查询</span>
    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    query<span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token class-name">Sort</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span><span class="token class-name">Sort<span class="token punctuation">.</span>Order</span><span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">&quot;salary&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//9.总条数</span>
    <span class="token keyword">long</span> count <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//10.去重  注意最后一个参数是返回的数据类型</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">findDistinct</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;salary&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">//11.JSON？？</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="添加" tabindex="-1"><a class="header-anchor" href="#添加" aria-hidden="true">#</a> 添加</h4><blockquote><p>文档添加--save</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token comment">//文档添加</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testAddDoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">User</span> ruyb1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">&quot;ruyb1&quot;</span><span class="token punctuation">,</span> <span class="token number">1200.0</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mongoTemplate<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>ruyb1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//mongoTemplate.insert();</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://picbed-for-mrru-mdfile.oss-cn-chengdu.aliyuncs.com/mrru-glodon/image-20220915093357930.png" alt="" loading="lazy"></p><p>再添加一条，但是对birthday加transent注解</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Double</span> salary<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Transient</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> birthday<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testAddDoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">User</span> ruyb2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&quot;ruyb2&quot;</span><span class="token punctuation">,</span> <span class="token number">1200.0</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mongoTemplate<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>ruyb2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://picbed-for-mrru-mdfile.oss-cn-chengdu.aliyuncs.com/mrru-glodon/image-20220915093705156.png" alt="image-20220915093705156" loading="lazy"></p><blockquote><p>文档添加--insert</p></blockquote><p>尝试再insert一次user1对象时，报错！</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>org.springframework.dao.DuplicateKeyException: Write operation error on server <span class="token number">127.0</span>.0.1:27017. Write error: WriteError<span class="token punctuation">{</span>code<span class="token operator">=</span><span class="token number">11000</span>, <span class="token assign-left variable">message</span><span class="token operator">=</span><span class="token string">&#39;E11000 duplicate key error collection: glodon.users index: _id_ dup key: { _id: 100 }&#39;</span>, <span class="token assign-left variable">details</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>.<span class="token punctuation">;</span> nested exception is com.mongodb.MongoWriteException: Write operation error on server <span class="token number">127.0</span>.0.1:27017. Write error: WriteError<span class="token punctuation">{</span>code<span class="token operator">=</span><span class="token number">11000</span>, <span class="token assign-left variable">message</span><span class="token operator">=</span><span class="token string">&#39;E11000 duplicate key error collection: glodon.users index: _id_ dup key: { _id: 100 }&#39;</span>, <span class="token assign-left variable">details</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><hr><p>批处理insert</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> userList <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token string">&quot;ruyb3&quot;</span><span class="token punctuation">,</span> <span class="token number">1300.0</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                    <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token string">&quot;ruyb4&quot;</span><span class="token punctuation">,</span> <span class="token number">1400.0</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//参数1：批量数据，参数2：指定放入哪个集合</span>
mongoTemplate<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>userList<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>总结</p><ul><li>批处理操作时（比如insert一个集合List）： <ul><li><code>save</code>只能一条条放，需遍历整个数据，一次插入或更新，效率较低。</li><li><code>insert</code>可以一次性插入整个数据，效率较高；<mark>批量处理推荐</mark></li></ul></li><li>插入重复数据时： <ul><li><code>save</code>对已存在的数据进行更新。</li><li><code>insert</code>报错<code>DuplicateKeyException</code>提示主键重复；</li></ul></li></ul><h4 id="更新" tabindex="-1"><a class="header-anchor" href="#更新" aria-hidden="true">#</a> 更新</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span>  <span class="token function">testUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//1.更新条件</span>
  <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token class-name">Query</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">&quot;ruyb2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//2.更新内容</span>
  <span class="token class-name">Update</span> update <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  update<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ruyb200&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//单条更新</span>
  mongoTemplate<span class="token punctuation">.</span><span class="token function">updateFirst</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> update<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//多条更新</span>
  mongoTemplate<span class="token punctuation">.</span><span class="token function">updateMulti</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> update<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//更新插入</span>
  mongoTemplate<span class="token punctuation">.</span><span class="token function">upsert</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span>update<span class="token punctuation">,</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//返回值均为 updateResult</span>
  <span class="token comment">//System.out.println(&quot;匹配条数:&quot; + updateResult.getMatchedCount());</span>
  <span class="token comment">//System.out.println(&quot;修改条数:&quot; + updateResult.getModifiedCount());</span>
  <span class="token comment">//System.out.println(&quot;插入id_:&quot; + updateResult.getUpsertedId());</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="删除" tabindex="-1"><a class="header-anchor" href="#删除" aria-hidden="true">#</a> 删除</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//删除所有</span>
  mongoTemplate<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//条件删除</span>
  mongoTemplate<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>
    <span class="token class-name">Query</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">&quot;ruyb200&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="springdata-mongorepository" tabindex="-1"><a class="header-anchor" href="#springdata-mongorepository" aria-hidden="true">#</a> SpringData-MongoRepository</h1><p>MongoRepository能够满足一般的需求开发，而且拿来即用即可</p><p><a href="https://blog.csdn.net/weixin_42806958/article/details/115768900" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/weixin_42806958/article/details/115768900<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="环境搭建-1" tabindex="-1"><a class="header-anchor" href="#环境搭建-1" aria-hidden="true">#</a> 环境搭建</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserRepository</span> <span class="token keyword">extends</span> <span class="token class-name">MongoRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="测试mongorepository" tabindex="-1"><a class="header-anchor" href="#测试mongorepository" aria-hidden="true">#</a> 测试mongorepository</h3><p>在springboot环境下 测试了mongorepository的功能</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MongoRepositoryTest</span> <span class="token keyword">extends</span> <span class="token class-name">ApplicationTests</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserRepository</span> userRepository<span class="token punctuation">;</span>

    <span class="token comment">//增加</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ParseException</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token string">&quot;001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;ruyb_&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setSalary</span><span class="token punctuation">(</span><span class="token number">2000.0</span> <span class="token operator">+</span> <span class="token number">100.0</span> <span class="token operator">*</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SimpleDateFormat</span> dateFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Date</span> date <span class="token operator">=</span> dateFormat<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;2022-09-15&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setBirthday</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>
            userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//删除</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        userRepository<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span><span class="token string">&quot;6322e0fdb641e92a9d818edb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//修改</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token string">&quot;6322e19c00bde16337ebe91f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setSalary</span><span class="token punctuation">(</span><span class="token number">9999.99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//查询所有</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> userList <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//查询通过id</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token string">&quot;6322e19c00bde16337ebe91f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//查询通过条件 example相当于一个对象，查出来和对象属性相同的数据</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findByCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ParseException</span> <span class="token punctuation">{</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;ruyb_0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//user.setId(&quot;001&quot;);</span>
        <span class="token comment">//user.setSalary(2000.0);</span>
        <span class="token comment">//SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>
        <span class="token comment">//Date date = dateFormat.parse(&quot;2022-09-15&quot;);</span>
        <span class="token comment">//user.setBirthday(date);</span>
        <span class="token class-name">Example</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> example <span class="token operator">=</span> <span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> userList <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>example<span class="token punctuation">)</span><span class="token punctuation">;</span>
        userList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//模糊查询</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findLikeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//创建匹配器，即如何使用查询条件</span>
        <span class="token comment">// 改变默认字符串匹配方式：模糊查询</span>
        <span class="token comment">// 改变默认大小写忽略方式：忽略大小写</span>
        <span class="token class-name">ExampleMatcher</span> matcher <span class="token operator">=</span> <span class="token class-name">ExampleMatcher</span><span class="token punctuation">.</span><span class="token function">matching</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withStringMatcher</span><span class="token punctuation">(</span><span class="token class-name">ExampleMatcher<span class="token punctuation">.</span>StringMatcher</span><span class="token punctuation">.</span><span class="token constant">CONTAINING</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withIgnoreCase</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;ruyb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//模糊查询条件</span>
        <span class="token class-name">Example</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> userExample <span class="token operator">=</span> <span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> matcher<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> userList <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>userExample<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">page</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//分页参数 参数1：第几页:，参数2：每页几条</span>
        <span class="token class-name">PageRequest</span> pageRequest <span class="token operator">=</span> <span class="token class-name">PageRequest</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PageRequest</span> pageRequest2 <span class="token operator">=</span> <span class="token class-name">PageRequest</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;ruyb_0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Example</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> example <span class="token operator">=</span> <span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> all <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>example<span class="token punctuation">,</span> pageRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">User</span> user1 <span class="token operator">:</span> all<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="api整理" tabindex="-1"><a class="header-anchor" href="#api整理" aria-hidden="true">#</a> API整理</h3><p>关于这一类，比较麻烦的地方就是不知道有哪些方法是JPA自动生成的。除了通过idea的提示可以做一部分判断，另一个方法还是要通过查看源码来判断。通过查看代码，发现每个类的Repository类都会继承<strong>MongoRepository</strong>，而MongoRepository继承了<strong>PagingAndSortingRepository</strong>，PagingAndSortingRepository继承<strong>CrudRepository</strong>，CrudRepository继承<strong>Repository</strong>。所以这几个Repository中已经有的方法都是JPA可以自动生成的。<strong>使用某一具体方法时可以在这几个Repository中查找是否有对应方法</strong></p><p>在这里我们需要区分两种情况：一种是<strong>本身的Repository类继承</strong>的那一些Repository提供的基本的数据操作方法，包含基本的增删改查、分页查询、排序查询等，对于这一种，在创建的Repository类中是不需要再申明方法的。另一种是我们可以自己写一些简单的方法，这些方法只需要<strong>符合Spring Data制定的那一类规范</strong>就能被其识别出来，对于这一种就需要在Repository类中声明方法。</p><h3 id="spring-data-repository接口" tabindex="-1"><a class="header-anchor" href="#spring-data-repository接口" aria-hidden="true">#</a> <mark>Spring Data Repository接口</mark></h3><p><a href="https://docs.spring.io/spring-data/mongodb/docs/2.2.2.RELEASE/reference/html/#repositories" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-data/mongodb/docs/2.2.2.RELEASE/reference/html/#repositories<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><code>CrudRepository</code> 接口定义的通用的底层持久性CRUD方法</p><p><img src="https://picbed-for-mrru-mdfile.oss-cn-chengdu.aliyuncs.com/mrru-glodon/image-20220919091640818.png" alt="image-20220919091640818" loading="lazy"></p><p><code>PagingAndSortingRepository</code>接口提供分页方法</p><p><img src="https://picbed-for-mrru-mdfile.oss-cn-chengdu.aliyuncs.com/mrru-glodon/image-20220919092419021.png" alt="image-20220919092419021" loading="lazy"></p><p><code>派生计数查询、删除方法</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">interface</span> <span class="token class-name">UserRepository</span> <span class="token keyword">extends</span> <span class="token class-name">CrudRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">long</span> <span class="token function">countByLastname</span><span class="token punctuation">(</span><span class="token class-name">String</span> lastname<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">long</span> <span class="token function">deleteByLastname</span><span class="token punctuation">(</span><span class="token class-name">String</span> lastname<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">removeByLastname</span><span class="token punctuation">(</span><span class="token class-name">String</span> lastname<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="mongodb-repository" tabindex="-1"><a class="header-anchor" href="#mongodb-repository" aria-hidden="true">#</a> <mark>MongoDB repository</mark></h3><p>文档很详细！！</p><p><a href="https://docs.spring.io/spring-data/mongodb/docs/2.2.2.RELEASE/reference/html/#mongo.repositories" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-data/mongodb/docs/2.2.2.RELEASE/reference/html/#mongo.repositories<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h4 id="支持查询方法的关键字" tabindex="-1"><a class="header-anchor" href="#支持查询方法的关键字" aria-hidden="true">#</a> <code>支持查询方法的关键字</code></h4><table><thead><tr><th style="text-align:left;">Keyword</th><th style="text-align:left;">Sample</th><th style="text-align:left;">Logical result</th></tr></thead><tbody><tr><td style="text-align:left;"><code>After</code></td><td style="text-align:left;"><code>findByBirthdateAfter(Date date)</code></td><td style="text-align:left;"><code>{&quot;birthdate&quot; : {&quot;$gt&quot; : date}}</code></td></tr><tr><td style="text-align:left;"><code>GreaterThan</code></td><td style="text-align:left;"><code>findByAgeGreaterThan(int age)</code></td><td style="text-align:left;"><code>{&quot;age&quot; : {&quot;$gt&quot; : age}}</code></td></tr><tr><td style="text-align:left;"><code>GreaterThanEqual</code></td><td style="text-align:left;"><code>findByAgeGreaterThanEqual(int age)</code></td><td style="text-align:left;"><code>{&quot;age&quot; : {&quot;$gte&quot; : age}}</code></td></tr><tr><td style="text-align:left;"><code>Before</code></td><td style="text-align:left;"><code>findByBirthdateBefore(Date date)</code></td><td style="text-align:left;"><code>{&quot;birthdate&quot; : {&quot;$lt&quot; : date}}</code></td></tr><tr><td style="text-align:left;"><code>LessThan</code></td><td style="text-align:left;"><code>findByAgeLessThan(int age)</code></td><td style="text-align:left;"><code>{&quot;age&quot; : {&quot;$lt&quot; : age}}</code></td></tr><tr><td style="text-align:left;"><code>LessThanEqual</code></td><td style="text-align:left;"><code>findByAgeLessThanEqual(int age)</code></td><td style="text-align:left;"><code>{&quot;age&quot; : {&quot;$lte&quot; : age}}</code></td></tr><tr><td style="text-align:left;"><code>Between</code></td><td style="text-align:left;"><code>findByAgeBetween(int from, int to)</code> <code>findByAgeBetween(Range&lt;Integer&gt; range)</code></td><td style="text-align:left;"><code>{&quot;age&quot; : {&quot;$gt&quot; : from, &quot;$lt&quot; : to}}</code> lower / upper bounds (<code>$gt</code> / <code>$gte</code> &amp; <code>$lt</code> / <code>$lte</code>) according to <code>Range</code></td></tr><tr><td style="text-align:left;"><code>In</code></td><td style="text-align:left;"><code>findByAgeIn(Collection ages)</code></td><td style="text-align:left;"><code>{&quot;age&quot; : {&quot;$in&quot; : [ages…]}}</code></td></tr><tr><td style="text-align:left;"><code>NotIn</code></td><td style="text-align:left;"><code>findByAgeNotIn(Collection ages)</code></td><td style="text-align:left;"><code>{&quot;age&quot; : {&quot;$nin&quot; : [ages…]}}</code></td></tr><tr><td style="text-align:left;"><code>IsNotNull</code>, <code>NotNull</code></td><td style="text-align:left;"><code>findByFirstnameNotNull()</code></td><td style="text-align:left;"><code>{&quot;firstname&quot; : {&quot;$ne&quot; : null}}</code></td></tr><tr><td style="text-align:left;"><code>IsNull</code>, <code>Null</code></td><td style="text-align:left;"><code>findByFirstnameNull()</code></td><td style="text-align:left;"><code>{&quot;firstname&quot; : null}</code></td></tr><tr><td style="text-align:left;"><code>Like</code>, <code>StartingWith</code>, <code>EndingWith</code></td><td style="text-align:left;"><code>findByFirstnameLike(String name)</code></td><td style="text-align:left;"><code>{&quot;firstname&quot; : name} (name as regex)</code></td></tr><tr><td style="text-align:left;"><code>NotLike</code>, <code>IsNotLike</code></td><td style="text-align:left;"><code>findByFirstnameNotLike(String name)</code></td><td style="text-align:left;"><code>{&quot;firstname&quot; : { &quot;$not&quot; : name }} (name as regex)</code></td></tr><tr><td style="text-align:left;"><code>Containing</code> on String</td><td style="text-align:left;"><code>findByFirstnameContaining(String name)</code></td><td style="text-align:left;"><code>{&quot;firstname&quot; : name} (name as regex)</code></td></tr><tr><td style="text-align:left;"><code>NotContaining</code> on String</td><td style="text-align:left;"><code>findByFirstnameNotContaining(String name)</code></td><td style="text-align:left;"><code>{&quot;firstname&quot; : { &quot;$not&quot; : name}} (name as regex)</code></td></tr><tr><td style="text-align:left;"><code>Containing</code> on Collection</td><td style="text-align:left;"><code>findByAddressesContaining(Address address)</code></td><td style="text-align:left;"><code>{&quot;addresses&quot; : { &quot;$in&quot; : address}}</code></td></tr><tr><td style="text-align:left;"><code>NotContaining</code> on Collection</td><td style="text-align:left;"><code>findByAddressesNotContaining(Address address)</code></td><td style="text-align:left;"><code>{&quot;addresses&quot; : { &quot;$not&quot; : { &quot;$in&quot; : address}}}</code></td></tr><tr><td style="text-align:left;"><code>Regex</code></td><td style="text-align:left;"><code>findByFirstnameRegex(String firstname)</code></td><td style="text-align:left;"><code>{&quot;firstname&quot; : {&quot;$regex&quot; : firstname }}</code></td></tr><tr><td style="text-align:left;"><code>(No keyword)</code></td><td style="text-align:left;"><code>findByFirstname(String name)</code></td><td style="text-align:left;"><code>{&quot;firstname&quot; : name}</code></td></tr><tr><td style="text-align:left;"><code>Not</code></td><td style="text-align:left;"><code>findByFirstnameNot(String name)</code></td><td style="text-align:left;"><code>{&quot;firstname&quot; : {&quot;$ne&quot; : name}}</code></td></tr><tr><td style="text-align:left;"><code>Near</code></td><td style="text-align:left;"><code>findByLocationNear(Point point)</code></td><td style="text-align:left;"><code>{&quot;location&quot; : {&quot;$near&quot; : [x,y]}}</code></td></tr><tr><td style="text-align:left;"><code>Near</code></td><td style="text-align:left;"><code>findByLocationNear(Point point, Distance max)</code></td><td style="text-align:left;"><code>{&quot;location&quot; : {&quot;$near&quot; : [x,y], &quot;$maxDistance&quot; : max}}</code></td></tr><tr><td style="text-align:left;"><code>Near</code></td><td style="text-align:left;"><code>findByLocationNear(Point point, Distance min, Distance max)</code></td><td style="text-align:left;"><code>{&quot;location&quot; : {&quot;$near&quot; : [x,y], &quot;$minDistance&quot; : min, &quot;$maxDistance&quot; : max}}</code></td></tr><tr><td style="text-align:left;"><code>Within</code></td><td style="text-align:left;"><code>findByLocationWithin(Circle circle)</code></td><td style="text-align:left;"><code>{&quot;location&quot; : {&quot;$geoWithin&quot; : {&quot;$center&quot; : [ [x, y], distance]}}}</code></td></tr><tr><td style="text-align:left;"><code>Within</code></td><td style="text-align:left;"><code>findByLocationWithin(Box box)</code></td><td style="text-align:left;"><code>{&quot;location&quot; : {&quot;$geoWithin&quot; : {&quot;$box&quot; : [ [x1, y1], x2, y2]}}}</code></td></tr><tr><td style="text-align:left;"><code>IsTrue</code>, <code>True</code></td><td style="text-align:left;"><code>findByActiveIsTrue()</code></td><td style="text-align:left;"><code>{&quot;active&quot; : true}</code></td></tr><tr><td style="text-align:left;"><code>IsFalse</code>, <code>False</code></td><td style="text-align:left;"><code>findByActiveIsFalse()</code></td><td style="text-align:left;"><code>{&quot;active&quot; : false}</code></td></tr><tr><td style="text-align:left;"><code>Exists</code></td><td style="text-align:left;"><code>findByLocationExists(boolean exists)</code></td><td style="text-align:left;"><code>{&quot;location&quot; : {&quot;$exists&quot; : exists }}</code></td></tr></tbody></table><h4 id="删除方法" tabindex="-1"><a class="header-anchor" href="#删除方法" aria-hidden="true">#</a> 删除方法</h4><p>可以返回列表或者删除的数</p><p><img src="https://picbed-for-mrru-mdfile.oss-cn-chengdu.aliyuncs.com/mrru-glodon/image-20220919094333237.png" alt="image-20220919094333237" loading="lazy"></p><h3 id="repository-query-keywords" tabindex="-1"><a class="header-anchor" href="#repository-query-keywords" aria-hidden="true">#</a> <mark>Repository query keywords</mark></h3><p>Spring data repository 查询派生机制通常支持的关键字</p><table><thead><tr><th style="text-align:left;">Logical keyword</th><th style="text-align:left;">Keyword expressions</th></tr></thead><tbody><tr><td style="text-align:left;"><code>AND</code></td><td style="text-align:left;"><code>And</code></td></tr><tr><td style="text-align:left;"><code>OR</code></td><td style="text-align:left;"><code>Or</code></td></tr><tr><td style="text-align:left;"><code>AFTER</code></td><td style="text-align:left;"><code>After</code>, <code>IsAfter</code></td></tr><tr><td style="text-align:left;"><code>BEFORE</code></td><td style="text-align:left;"><code>Before</code>, <code>IsBefore</code></td></tr><tr><td style="text-align:left;"><code>CONTAINING</code></td><td style="text-align:left;"><code>Containing</code>, <code>IsContaining</code>, <code>Contains</code></td></tr><tr><td style="text-align:left;"><code>BETWEEN</code></td><td style="text-align:left;"><code>Between</code>, <code>IsBetween</code></td></tr><tr><td style="text-align:left;"><code>ENDING_WITH</code></td><td style="text-align:left;"><code>EndingWith</code>, <code>IsEndingWith</code>, <code>EndsWith</code></td></tr><tr><td style="text-align:left;"><code>EXISTS</code></td><td style="text-align:left;"><code>Exists</code></td></tr><tr><td style="text-align:left;"><code>FALSE</code></td><td style="text-align:left;"><code>False</code>, <code>IsFalse</code></td></tr><tr><td style="text-align:left;"><code>GREATER_THAN</code></td><td style="text-align:left;"><code>GreaterThan</code>, <code>IsGreaterThan</code></td></tr><tr><td style="text-align:left;"><code>GREATER_THAN_EQUALS</code></td><td style="text-align:left;"><code>GreaterThanEqual</code>, <code>IsGreaterThanEqual</code></td></tr><tr><td style="text-align:left;"><code>IN</code></td><td style="text-align:left;"><code>In</code>, <code>IsIn</code></td></tr><tr><td style="text-align:left;"><code>IS</code></td><td style="text-align:left;"><code>Is</code>, <code>Equals</code>, (or no keyword)</td></tr><tr><td style="text-align:left;"><code>IS_EMPTY</code></td><td style="text-align:left;"><code>IsEmpty</code>, <code>Empty</code></td></tr><tr><td style="text-align:left;"><code>IS_NOT_EMPTY</code></td><td style="text-align:left;"><code>IsNotEmpty</code>, <code>NotEmpty</code></td></tr><tr><td style="text-align:left;"><code>IS_NOT_NULL</code></td><td style="text-align:left;"><code>NotNull</code>, <code>IsNotNull</code></td></tr><tr><td style="text-align:left;"><code>IS_NULL</code></td><td style="text-align:left;"><code>Null</code>, <code>IsNull</code></td></tr><tr><td style="text-align:left;"><code>LESS_THAN</code></td><td style="text-align:left;"><code>LessThan</code>, <code>IsLessThan</code></td></tr><tr><td style="text-align:left;"><code>LESS_THAN_EQUAL</code></td><td style="text-align:left;"><code>LessThanEqual</code>, <code>IsLessThanEqual</code></td></tr><tr><td style="text-align:left;"><code>LIKE</code></td><td style="text-align:left;"><code>Like</code>, <code>IsLike</code></td></tr><tr><td style="text-align:left;"><code>NEAR</code></td><td style="text-align:left;"><code>Near</code>, <code>IsNear</code></td></tr><tr><td style="text-align:left;"><code>NOT</code></td><td style="text-align:left;"><code>Not</code>, <code>IsNot</code></td></tr><tr><td style="text-align:left;"><code>NOT_IN</code></td><td style="text-align:left;"><code>NotIn</code>, <code>IsNotIn</code></td></tr><tr><td style="text-align:left;"><code>NOT_LIKE</code></td><td style="text-align:left;"><code>NotLike</code>, <code>IsNotLike</code></td></tr><tr><td style="text-align:left;"><code>REGEX</code></td><td style="text-align:left;"><code>Regex</code>, <code>MatchesRegex</code>, <code>Matches</code></td></tr><tr><td style="text-align:left;"><code>STARTING_WITH</code></td><td style="text-align:left;"><code>StartingWith</code>, <code>IsStartingWith</code>, <code>StartsWith</code></td></tr><tr><td style="text-align:left;"><code>TRUE</code></td><td style="text-align:left;"><code>True</code>, <code>IsTrue</code></td></tr><tr><td style="text-align:left;"><code>WITHIN</code></td><td style="text-align:left;"><code>Within</code>, <code>IsWithin</code></td></tr></tbody></table><h3 id="example类" tabindex="-1"><a class="header-anchor" href="#example类" aria-hidden="true">#</a> Example类</h3><p><a href="https://blog.csdn.net/weixin_41326813/article/details/108708712" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/weixin_41326813/article/details/108708712<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>Example用来模糊搜索</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ProxyUtils</span></span><span class="token punctuation">;</span>

<span class="token comment">//支持示例查询</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Example</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    
    <span class="token comment">//Create a new Example including all non-null properties by default.</span>
    <span class="token comment">//probe是实体类 包含用于查询的参数  不能为空</span>
    <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Example</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">T</span> probe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TypedExample</span><span class="token punctuation">(</span>probe<span class="token punctuation">,</span> <span class="token class-name">ExampleMatcher</span><span class="token punctuation">.</span><span class="token function">matching</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
	<span class="token comment">//Create a new Example using the given ExampleMatcher.</span>
    <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Example</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">T</span> probe<span class="token punctuation">,</span> <span class="token class-name">ExampleMatcher</span> matcher<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TypedExample</span><span class="token punctuation">(</span>probe<span class="token punctuation">,</span> matcher<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">T</span> <span class="token function">getProbe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">ExampleMatcher</span> <span class="token function">getMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">default</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">getProbeType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">ProxyUtils</span><span class="token punctuation">.</span><span class="token function">getUserClass</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getProbe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="问题讨论" tabindex="-1"><a class="header-anchor" href="#问题讨论" aria-hidden="true">#</a> 问题讨论</h1><blockquote><p>问题1：能否通过mongoTemplate只查询某个字段</p></blockquote><p>能。可以通过mongoTemplate的BasicQuery的构造方法封装查询条件、显示字段进行查询，构造函数API如下：</p><p><strong>BasicQuery 类：自定义查询实现，从任意JSON查询字符串设置基本查询。</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
* Create a new <span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token class-name">BasicQuery</span></span><span class="token punctuation">}</span> given a JSON <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java">query</span></span><span class="token punctuation">}</span> and <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java">fields</span></span><span class="token punctuation">}</span>.
* <span class="token keyword">@param</span> <span class="token parameter">query</span> may be <span class="token punctuation">{</span><span class="token keyword">@literal</span> null<span class="token punctuation">}</span>. 参数1：查询条件
* <span class="token keyword">@param</span> <span class="token parameter">fields</span> may be <span class="token punctuation">{</span><span class="token keyword">@literal</span> null<span class="token punctuation">}</span>. 参数2：控制显示字段
*/</span>
<span class="token keyword">public</span> <span class="token class-name">BasicQuery</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> query<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> fields<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">(</span>query <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token class-name">Document</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         fields <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token class-name">Document</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>fields<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>本质上是<mark>通过JSON查询</mark>，所以以下直接用<mark>JSON格式</mark>封装查询条件和显示字段</p><blockquote><p>问题2：当文档的某字段数据量大的情况下，只查询该字段和查询该文档的效率哪个高？</p></blockquote><h2 id="查出一条文档指定字段-json" tabindex="-1"><a class="header-anchor" href="#查出一条文档指定字段-json" aria-hidden="true">#</a> 查出一条文档指定字段 JSON</h2><p>测试在SpringBoot 2.7.3 版本，引入spring-boot-starter-data-mongodb依赖进行</p><p><strong>实体类User</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>collection <span class="token operator">=</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Double</span> salary<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> birthday<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>测试类</strong>MongoTemplateTests通过构造注入mongoTemplate实例对象，测试方法如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//查询一个字段数据的时间  JSON查询  705  661 637</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFindField03</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Query</span> query2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BasicQuery</span><span class="token punctuation">(</span><span class="token string">&quot;{salary:{$gt:3000}}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;{username:1, _id:0}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&gt;</span></span> userList2 <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query2<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userList2<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;查询一条数据的时间：&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>执行结果：</strong></p><p>为避免控制台输出的影响，对比运行时注释掉第8行输出语句</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#username是String类型字段，长度444（为下面对比查询整条数据的效率）</span>
<span class="token comment">#{username=ruyb_4还记得看干啥的萨科技和打开的骄傲看到了扩大时刻到了哈萨我quiet请问IU让我去高...}</span>
查询一条数据的时间：705 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查出一条文档指定字段-query-field" tabindex="-1"><a class="header-anchor" href="#查出一条文档指定字段-query-field" aria-hidden="true">#</a> 查出一条文档指定字段 query.field</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//查询一个字段数据的时间  query.fields()  657 664 648</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFindField04</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Criteria</span> criteria <span class="token operator">=</span> <span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;salary&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">gt</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Field</span> field <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">fields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exclude</span><span class="token punctuation">(</span><span class="token string">&quot;_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;salary&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;birthday&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&gt;</span></span> userList2 <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userList2<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;查询一条数据的时间：&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查出一条文档" tabindex="-1"><a class="header-anchor" href="#查出一条文档" aria-hidden="true">#</a> 查出一条文档</h2><p>对比同样查询条件、查出该条文档数据（不去筛选字段）</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//测试查询一条数据的时间  普通 575 561 577</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFindField02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Query</span> query2 <span class="token operator">=</span> <span class="token class-name">Query</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;salary&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">gt</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&gt;</span></span> userList2 <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query2<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userList2<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;查询一条数据的时间：&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h2><p>查询一条文档的指定字段 JSON格式 耗时 <strong>667</strong> ms</p><p>查询一条文档的指定字段 query.field格式 耗时 <strong>656</strong> ms</p><p>查询一条文档 耗时 <strong>571</strong> ms</p><p>通过mongoTemplate只查询文档的某个字段的效率并不如查询整条数据高，查询指定字段的方法实际上只是控制了字段的显示和关闭</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/ru12321/edit/main/docs/tech/database/mongoDB.md" rel="noopener noreferrer" target="_blank" aria-label="在GitHub上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在GitHub上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: ruyb@glodon.com">ruyb</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><!----><a href="/tech/database/mybatis.html" class="nav-link next" aria-label="MyBatis"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">MyBatis<!----></div></a></nav><div class="waline-wrapper" id="comment" darkmode="false" style="display:block;"><div data-waline provider="Waline"><!--v-if--><div class="wl-comment"><!--v-if--><div class="wl-panel"><div class="wl-header item3"><!--[--><div class="wl-header-item"><label for="wl-nick">昵称</label><input id="wl-nick" class="wl-input wl-nick" name="nick" type="text" value></div><div class="wl-header-item"><label for="wl-mail">邮箱</label><input id="wl-mail" class="wl-input wl-mail" name="mail" type="email" value></div><div class="wl-header-item"><label for="wl-link">网址</label><input id="wl-link" class="wl-input wl-link" name="link" type="text" value></div><!--]--></div><textarea id="wl-edit" class="wl-editor" placeholder="请留言。(填写邮箱可在被回复时收到邮件提醒)"></textarea><div class="wl-preview" style="display:none;"><hr><h4>预览:</h4><div class="wl-content"></div></div><div class="wl-footer"><div class="wl-actions"><a href="https://guides.github.com/features/mastering-markdown/" title="Markdown Guide" aria-label="Markdown is supported" class="wl-action" target="_blank" rel="noopener noreferrer"><svg width="16" height="16" ariaHidden="true"><path d="M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z" fill="currentColor"></path></svg></a><button type="button" class="wl-action" title="表情" style="display:none;"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M563.2 463.3 677 540c1.7 1.2 3.7 1.8 5.8 1.8.7 0 1.4-.1 2-.2 2.7-.5 5.1-2.1 6.6-4.4l25.3-37.8c1.5-2.3 2.1-5.1 1.6-7.8s-2.1-5.1-4.4-6.6l-73.6-49.1 73.6-49.1c2.3-1.5 3.9-3.9 4.4-6.6.5-2.7 0-5.5-1.6-7.8l-25.3-37.8a10.1 10.1 0 0 0-6.6-4.4c-.7-.1-1.3-.2-2-.2-2.1 0-4.1.6-5.8 1.8l-113.8 76.6c-9.2 6.2-14.7 16.4-14.7 27.5.1 11 5.5 21.3 14.7 27.4zM387 348.8h-45.5c-5.7 0-10.4 4.7-10.4 10.4v153.3c0 5.7 4.7 10.4 10.4 10.4H387c5.7 0 10.4-4.7 10.4-10.4V359.2c0-5.7-4.7-10.4-10.4-10.4zm333.8 241.3-41-20a10.3 10.3 0 0 0-8.1-.5c-2.6.9-4.8 2.9-5.9 5.4-30.1 64.9-93.1 109.1-164.4 115.2-5.7.5-9.9 5.5-9.5 11.2l3.9 45.5c.5 5.3 5 9.5 10.3 9.5h.9c94.8-8 178.5-66.5 218.6-152.7 2.4-5 .3-11.2-4.8-13.6zm186-186.1c-11.9-42-30.5-81.4-55.2-117.1-24.1-34.9-53.5-65.6-87.5-91.2-33.9-25.6-71.5-45.5-111.6-59.2-41.2-14-84.1-21.1-127.8-21.1h-1.2c-75.4 0-148.8 21.4-212.5 61.7-63.7 40.3-114.3 97.6-146.5 165.8-32.2 68.1-44.3 143.6-35.1 218.4 9.3 74.8 39.4 145 87.3 203.3.1.2.3.3.4.5l36.2 38.4c1.1 1.2 2.5 2.1 3.9 2.6 73.3 66.7 168.2 103.5 267.5 103.5 73.3 0 145.2-20.3 207.7-58.7 37.3-22.9 70.3-51.5 98.1-85 27.1-32.7 48.7-69.5 64.2-109.1 15.5-39.7 24.4-81.3 26.6-123.8 2.4-43.6-2.5-87-14.5-129zm-60.5 181.1c-8.3 37-22.8 72-43 104-19.7 31.1-44.3 58.6-73.1 81.7-28.8 23.1-61 41-95.7 53.4-35.6 12.7-72.9 19.1-110.9 19.1-82.6 0-161.7-30.6-222.8-86.2l-34.1-35.8c-23.9-29.3-42.4-62.2-55.1-97.7-12.4-34.7-18.8-71-19.2-107.9-.4-36.9 5.4-73.3 17.1-108.2 12-35.8 30-69.2 53.4-99.1 31.7-40.4 71.1-72 117.2-94.1 44.5-21.3 94-32.6 143.4-32.6 49.3 0 97 10.8 141.8 32 34.3 16.3 65.3 38.1 92 64.8 26.1 26 47.5 56 63.6 89.2 16.2 33.2 26.6 68.5 31 105.1 4.6 37.5 2.7 75.3-5.6 112.3z" fill="currentColor"></path></svg></button><button type="button" class="wl-action" title="表情包"><svg width="24" height="24" fill="currentcolor" viewBox="0 0 24 24"><path style="transform: translateY(0.5px)" d="M18.968 10.5H15.968V11.484H17.984V12.984H15.968V15H14.468V9H18.968V10.5V10.5ZM8.984 9C9.26533 9 9.49967 9.09367 9.687 9.281C9.87433 9.46833 9.968 9.70267 9.968 9.984V10.5H6.499V13.5H8.468V12H9.968V14.016C9.968 14.2973 9.87433 14.5317 9.687 14.719C9.49967 14.9063 9.26533 15 8.984 15H5.984C5.70267 15 5.46833 14.9063 5.281 14.719C5.09367 14.5317 5 14.2973 5 14.016V9.985C5 9.70367 5.09367 9.46933 5.281 9.282C5.46833 9.09467 5.70267 9.001 5.984 9.001H8.984V9ZM11.468 9H12.968V15H11.468V9V9Z"></path><path d="M18.5 3H5.75C3.6875 3 2 4.6875 2 6.75V18C2 20.0625 3.6875 21.75 5.75 21.75H18.5C20.5625 21.75 22.25 20.0625 22.25 18V6.75C22.25 4.6875 20.5625 3 18.5 3ZM20.75 18C20.75 19.2375 19.7375 20.25 18.5 20.25H5.75C4.5125 20.25 3.5 19.2375 3.5 18V6.75C3.5 5.5125 4.5125 4.5 5.75 4.5H18.5C19.7375 4.5 20.75 5.5125 20.75 6.75V18Z"></path></svg></button><input id="wl-image-upload" class="upload" type="file" accept=".png,.jpg,.jpeg,.webp,.bmp,.gif"><label for="wl-image-upload" class="wl-action" title="上传图片"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M784 112H240c-88 0-160 72-160 160v480c0 88 72 160 160 160h544c88 0 160-72 160-160V272c0-88-72-160-160-160zm96 640c0 52.8-43.2 96-96 96H240c-52.8 0-96-43.2-96-96V272c0-52.8 43.2-96 96-96h544c52.8 0 96 43.2 96 96v480z" fill="currentColor"></path><path d="M352 480c52.8 0 96-43.2 96-96s-43.2-96-96-96-96 43.2-96 96 43.2 96 96 96zm0-128c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm462.4 379.2-3.2-3.2-177.6-177.6c-25.6-25.6-65.6-25.6-91.2 0l-80 80-36.8-36.8c-25.6-25.6-65.6-25.6-91.2 0L200 728c-4.8 6.4-8 14.4-8 24 0 17.6 14.4 32 32 32 9.6 0 16-3.2 22.4-9.6L380.8 640l134.4 134.4c6.4 6.4 14.4 9.6 24 9.6 17.6 0 32-14.4 32-32 0-9.6-4.8-17.6-9.6-24l-52.8-52.8 80-80L769.6 776c6.4 4.8 12.8 8 20.8 8 17.6 0 32-14.4 32-32 0-8-3.2-16-8-20.8z" fill="currentColor"></path></svg></label><button type="button" class="wl-action" title="预览"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M710.816 654.301c70.323-96.639 61.084-230.578-23.705-314.843-46.098-46.098-107.183-71.109-172.28-71.109-65.008 0-126.092 25.444-172.28 71.109-45.227 46.098-70.756 107.183-70.756 172.106 0 64.923 25.444 126.007 71.194 172.106 46.099 46.098 107.184 71.109 172.28 71.109 51.414 0 100.648-16.212 142.824-47.404l126.53 126.006c7.058 7.06 16.297 10.979 26.406 10.979 10.105 0 19.343-3.919 26.402-10.979 14.467-14.467 14.467-38.172 0-52.723L710.816 654.301zm-315.107-23.265c-65.88-65.88-65.88-172.54 0-238.42 32.069-32.07 74.245-49.149 119.471-49.149 45.227 0 87.407 17.603 119.472 49.149 65.88 65.879 65.88 172.539 0 238.42-63.612 63.178-175.242 63.178-238.943 0zm0 0" fill="currentColor"></path><path d="M703.319 121.603H321.03c-109.8 0-199.469 89.146-199.469 199.38v382.034c0 109.796 89.236 199.38 199.469 199.38h207.397c20.653 0 37.384-16.645 37.384-37.299 0-20.649-16.731-37.296-37.384-37.296H321.03c-68.582 0-124.352-55.77-124.352-124.267V321.421c0-68.496 55.77-124.267 124.352-124.267h382.289c68.582 0 124.352 55.771 124.352 124.267V524.72c0 20.654 16.736 37.299 37.385 37.299 20.654 0 37.384-16.645 37.384-37.299V320.549c-.085-109.8-89.321-198.946-199.121-198.946zm0 0" fill="currentColor"></path></svg></button></div><div class="wl-info"><div class="wl-text-number">0 <!--v-if-->  字</div><!--v-if--><button type="submit" class="primary wl-btn" title="Cmd|Ctrl + Enter"><!--[-->提交<!--]--></button></div><div class="wl-gif-popup"><input type="text" placeholder="搜索表情包"><div class="wl-gallery" style="gap:6px;"><!--[--><!--]--></div><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div></div><div class="wl-emoji-popup"><!--[--><!--]--><!--v-if--></div></div></div><!--v-if--></div><div class="wl-meta-head"><div class="wl-count"><!--v-if--> 评论</div><ul class="wl-sort"><!--[--><li class="active">按正序</li><li class="">按倒序</li><li class="">按热度</li><!--]--></ul></div><div class="wl-cards"><!--[--><!--]--></div><!--[--><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div><!--]--><div class="wl-power"> Powered by <a href="https://github.com/walinejs/waline" target="_blank" rel="noopener noreferrer"> Waline </a> v2.14.8</div></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">天若有情天亦老，人间正道是沧桑</div><div class="copyright">Copyright © 2024 Mr.Ru</div></footer></div><!--]--><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-c5d81740.js" defer></script>
  </body>
</html>
